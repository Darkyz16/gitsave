{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":88,"index":178}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":179},"end":{"line":3,"column":37,"index":216}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _servicesApi = require(_dependencyMap[1], \"../services/api\");\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [isAuthenticated, setIsAuthenticated] = (0, _react.useState)(false);\n\n    // Vérifier l'authentification au chargement\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await _servicesApi.secureStorage.getItem('jwt_token');\n        if (token) {\n          // Vérifier si le token est valide\n          const userData = await _servicesApi.authAPI.getCurrentUser();\n          setUser(userData);\n          setIsAuthenticated(true);\n        } else {\n          setIsAuthenticated(false);\n          setUser(null);\n        }\n      } catch (error) {\n        console.error('Erreur lors de la vérification de l\\'authentification:', error);\n        setIsAuthenticated(false);\n        setUser(null);\n        // Supprimer le token s'il est invalide\n        await _servicesApi.secureStorage.deleteItem('jwt_token');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const register = async data => {\n      try {\n        setIsLoading(true);\n        // Inscription\n        const newUser = await _servicesApi.authAPI.register(data);\n\n        // Connexion automatique après inscription\n        const tokenResponse = await _servicesApi.authAPI.login({\n          email: data.email,\n          password: data.password\n        });\n\n        // Stocker le token de manière sécurisée\n        await _servicesApi.secureStorage.setItem('jwt_token', tokenResponse.access_token);\n        setUser(newUser);\n        setIsAuthenticated(true);\n\n        // Rediriger vers l'écran principal\n        _expoRouter.router.replace('/(protected)/home');\n      } catch (error) {\n        console.error('Erreur lors de l\\'inscription:', error);\n        throw new Error(error.response?.data?.detail || 'Une erreur est survenue lors de l\\'inscription');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async data => {\n      try {\n        setIsLoading(true);\n        // Connexion\n        const tokenResponse = await _servicesApi.authAPI.login(data);\n\n        // Stocker le token de manière sécurisée\n        await _servicesApi.secureStorage.setItem('jwt_token', tokenResponse.access_token);\n\n        // Récupérer les données utilisateur\n        const userData = await _servicesApi.authAPI.getCurrentUser();\n        setUser(userData);\n        setIsAuthenticated(true);\n\n        // Rediriger vers l'écran principal\n        _expoRouter.router.replace('/(protected)/home');\n      } catch (error) {\n        console.error('Erreur lors de la connexion:', error);\n        throw new Error(error.response?.data?.detail || 'Email ou mot de passe incorrect');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        setIsLoading(true);\n        // Supprimer le token\n        await _servicesApi.secureStorage.deleteItem('jwt_token');\n        setUser(null);\n        setIsAuthenticated(false);\n\n        // Rediriger vers l'écran de connexion\n        _expoRouter.router.replace('/');\n      } catch (error) {\n        console.error('Erreur lors de la déconnexion:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isAuthenticated,\n        isLoading,\n        login,\n        register,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth doit être utilisé à l\\'intérieur d\\'un AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":147,"map":[[8,2,17,0,"Object"],[8,8,17,0],[8,9,17,0,"defineProperty"],[8,23,17,0],[8,24,17,0,"exports"],[8,31,17,0],[9,4,17,0,"enumerable"],[9,14,17,0],[10,4,17,0,"get"],[10,7,17,0],[10,18,17,0,"get"],[10,19,17,0],[11,6,17,0],[11,13,17,0,"AuthProvider"],[11,25,17,0],[12,4,17,0],[13,2,17,0],[14,2,142,0,"Object"],[14,8,142,0],[14,9,142,0,"defineProperty"],[14,23,142,0],[14,24,142,0,"exports"],[14,31,142,0],[15,4,142,0,"enumerable"],[15,14,142,0],[16,4,142,0,"get"],[16,7,142,0],[16,18,142,0,"get"],[16,19,142,0],[17,6,142,0],[17,13,142,0,"useAuth"],[17,20,142,0],[18,4,142,0],[19,2,142,0],[20,2,1,0],[20,6,1,0,"_react"],[20,12,1,0],[20,15,1,0,"require"],[20,22,1,0],[20,23,1,0,"_dependencyMap"],[20,37,1,0],[21,2,2,0],[21,6,2,0,"_servicesApi"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_expoRouter"],[22,17,3,0],[22,20,3,0,"require"],[22,27,3,0],[22,28,3,0,"_dependencyMap"],[22,42,3,0],[23,2,3,37],[23,6,3,37,"_reactJsxDevRuntime"],[23,25,3,37],[23,28,3,37,"require"],[23,35,3,37],[23,36,3,37,"_dependencyMap"],[23,50,3,37],[24,2,15,0],[24,8,15,6,"AuthContext"],[24,19,15,17],[24,35,15,20],[24,39,15,20,"createContext"],[24,45,15,33],[24,46,15,33,"createContext"],[24,59,15,33],[24,61,15,63,"undefined"],[24,70,15,72],[24,71,15,73],[25,2,17,7],[25,8,17,13,"AuthProvider"],[25,20,17,25],[25,23,17,28,"AuthProvider"],[25,24,17,29],[26,4,17,31,"children"],[27,2,17,65],[27,3,17,66],[27,8,17,71],[28,4,18,2],[28,10,18,8],[28,11,18,9,"user"],[28,15,18,13],[28,17,18,15,"setUser"],[28,24,18,22],[28,25,18,23],[28,28,18,26],[28,32,18,26,"useState"],[28,38,18,34],[28,39,18,34,"useState"],[28,47,18,34],[28,49,18,48],[28,53,18,52],[28,54,18,53],[29,4,19,2],[29,10,19,8],[29,11,19,9,"isLoading"],[29,20,19,18],[29,22,19,20,"setIsLoading"],[29,34,19,32],[29,35,19,33],[29,38,19,36],[29,42,19,36,"useState"],[29,48,19,44],[29,49,19,44,"useState"],[29,57,19,44],[29,59,19,45],[29,63,19,49],[29,64,19,50],[30,4,20,2],[30,10,20,8],[30,11,20,9,"isAuthenticated"],[30,26,20,24],[30,28,20,26,"setIsAuthenticated"],[30,46,20,44],[30,47,20,45],[30,50,20,48],[30,54,20,48,"useState"],[30,60,20,56],[30,61,20,56,"useState"],[30,69,20,56],[30,71,20,57],[30,76,20,62],[30,77,20,63],[32,4,22,2],[33,4,23,2],[33,8,23,2,"useEffect"],[33,14,23,11],[33,15,23,11,"useEffect"],[33,24,23,11],[33,26,23,12],[33,32,23,18],[34,6,24,4,"checkAuth"],[34,15,24,13],[34,16,24,14],[34,17,24,15],[35,4,25,2],[35,5,25,3],[35,7,25,5],[35,9,25,7],[35,10,25,8],[36,4,27,2],[36,10,27,8,"checkAuth"],[36,19,27,17],[36,22,27,20],[36,28,27,20,"checkAuth"],[36,29,27,20],[36,34,27,32],[37,6,28,4],[37,10,28,8],[38,8,29,6],[38,14,29,12,"token"],[38,19,29,17],[38,22,29,20],[38,28,29,26,"secureStorage"],[38,40,29,39],[38,41,29,39,"secureStorage"],[38,54,29,39],[38,55,29,40,"getItem"],[38,62,29,47],[38,63,29,48],[38,74,29,59],[38,75,29,60],[39,8,30,6],[39,12,30,10,"token"],[39,17,30,15],[39,19,30,17],[40,10,31,8],[41,10,32,8],[41,16,32,14,"userData"],[41,24,32,22],[41,27,32,25],[41,33,32,31,"authAPI"],[41,45,32,38],[41,46,32,38,"authAPI"],[41,53,32,38],[41,54,32,39,"getCurrentUser"],[41,68,32,53],[41,69,32,54],[41,70,32,55],[42,10,33,8,"setUser"],[42,17,33,15],[42,18,33,16,"userData"],[42,26,33,24],[42,27,33,25],[43,10,34,8,"setIsAuthenticated"],[43,28,34,26],[43,29,34,27],[43,33,34,31],[43,34,34,32],[44,8,35,6],[44,9,35,7],[44,15,35,13],[45,10,36,8,"setIsAuthenticated"],[45,28,36,26],[45,29,36,27],[45,34,36,32],[45,35,36,33],[46,10,37,8,"setUser"],[46,17,37,15],[46,18,37,16],[46,22,37,20],[46,23,37,21],[47,8,38,6],[48,6,39,4],[48,7,39,5],[48,8,39,6],[48,15,39,13,"error"],[48,20,39,18],[48,22,39,20],[49,8,40,6,"console"],[49,15,40,13],[49,16,40,14,"error"],[49,21,40,19],[49,22,40,20],[49,78,40,76],[49,80,40,78,"error"],[49,85,40,83],[49,86,40,84],[50,8,41,6,"setIsAuthenticated"],[50,26,41,24],[50,27,41,25],[50,32,41,30],[50,33,41,31],[51,8,42,6,"setUser"],[51,15,42,13],[51,16,42,14],[51,20,42,18],[51,21,42,19],[52,8,43,6],[53,8,44,6],[53,14,44,12,"secureStorage"],[53,26,44,25],[53,27,44,25,"secureStorage"],[53,40,44,25],[53,41,44,26,"deleteItem"],[53,51,44,36],[53,52,44,37],[53,63,44,48],[53,64,44,49],[54,6,45,4],[54,7,45,5],[54,16,45,14],[55,8,46,6,"setIsLoading"],[55,20,46,18],[55,21,46,19],[55,26,46,24],[55,27,46,25],[56,6,47,4],[57,4,48,2],[57,5,48,3],[58,4,50,2],[58,10,50,8,"register"],[58,18,50,16],[58,21,50,19],[58,27,50,26,"data"],[58,31,50,44],[58,35,50,49],[59,6,51,4],[59,10,51,8],[60,8,52,6,"setIsLoading"],[60,20,52,18],[60,21,52,19],[60,25,52,23],[60,26,52,24],[61,8,53,6],[62,8,54,6],[62,14,54,12,"newUser"],[62,21,54,19],[62,24,54,22],[62,30,54,28,"authAPI"],[62,42,54,35],[62,43,54,35,"authAPI"],[62,50,54,35],[62,51,54,36,"register"],[62,59,54,44],[62,60,54,45,"data"],[62,64,54,49],[62,65,54,50],[64,8,56,6],[65,8,57,6],[65,14,57,12,"tokenResponse"],[65,27,57,25],[65,30,57,28],[65,36,57,34,"authAPI"],[65,48,57,41],[65,49,57,41,"authAPI"],[65,56,57,41],[65,57,57,42,"login"],[65,62,57,47],[65,63,57,48],[66,10,58,8,"email"],[66,15,58,13],[66,17,58,15,"data"],[66,21,58,19],[66,22,58,20,"email"],[66,27,58,25],[67,10,59,8,"password"],[67,18,59,16],[67,20,59,18,"data"],[67,24,59,22],[67,25,59,23,"password"],[68,8,60,6],[68,9,60,7],[68,10,60,8],[70,8,62,6],[71,8,63,6],[71,14,63,12,"secureStorage"],[71,26,63,25],[71,27,63,25,"secureStorage"],[71,40,63,25],[71,41,63,26,"setItem"],[71,48,63,33],[71,49,63,34],[71,60,63,45],[71,62,63,47,"tokenResponse"],[71,75,63,60],[71,76,63,61,"access_token"],[71,88,63,73],[71,89,63,74],[72,8,65,6,"setUser"],[72,15,65,13],[72,16,65,14,"newUser"],[72,23,65,21],[72,24,65,22],[73,8,66,6,"setIsAuthenticated"],[73,26,66,24],[73,27,66,25],[73,31,66,29],[73,32,66,30],[75,8,68,6],[76,8,69,6,"router"],[76,19,69,12],[76,20,69,12,"router"],[76,26,69,12],[76,27,69,13,"replace"],[76,34,69,20],[76,35,69,21],[76,54,69,40],[76,55,69,41],[77,6,70,4],[77,7,70,5],[77,8,70,6],[77,15,70,13,"error"],[77,20,70,23],[77,22,70,25],[78,8,71,6,"console"],[78,15,71,13],[78,16,71,14,"error"],[78,21,71,19],[78,22,71,20],[78,54,71,52],[78,56,71,54,"error"],[78,61,71,59],[78,62,71,60],[79,8,72,6],[79,14,72,12],[79,18,72,16,"Error"],[79,23,72,21],[79,24,73,8,"error"],[79,29,73,13],[79,30,73,14,"response"],[79,38,73,22],[79,40,73,24,"data"],[79,44,73,28],[79,46,73,30,"detail"],[79,52,73,36],[79,56,74,8],[79,104,75,6],[79,105,75,7],[80,6,76,4],[80,7,76,5],[80,16,76,14],[81,8,77,6,"setIsLoading"],[81,20,77,18],[81,21,77,19],[81,26,77,24],[81,27,77,25],[82,6,78,4],[83,4,79,2],[83,5,79,3],[84,4,81,2],[84,10,81,8,"login"],[84,15,81,13],[84,18,81,16],[84,24,81,23,"data"],[84,28,81,38],[84,32,81,43],[85,6,82,4],[85,10,82,8],[86,8,83,6,"setIsLoading"],[86,20,83,18],[86,21,83,19],[86,25,83,23],[86,26,83,24],[87,8,84,6],[88,8,85,6],[88,14,85,12,"tokenResponse"],[88,27,85,25],[88,30,85,28],[88,36,85,34,"authAPI"],[88,48,85,41],[88,49,85,41,"authAPI"],[88,56,85,41],[88,57,85,42,"login"],[88,62,85,47],[88,63,85,48,"data"],[88,67,85,52],[88,68,85,53],[90,8,87,6],[91,8,88,6],[91,14,88,12,"secureStorage"],[91,26,88,25],[91,27,88,25,"secureStorage"],[91,40,88,25],[91,41,88,26,"setItem"],[91,48,88,33],[91,49,88,34],[91,60,88,45],[91,62,88,47,"tokenResponse"],[91,75,88,60],[91,76,88,61,"access_token"],[91,88,88,73],[91,89,88,74],[93,8,90,6],[94,8,91,6],[94,14,91,12,"userData"],[94,22,91,20],[94,25,91,23],[94,31,91,29,"authAPI"],[94,43,91,36],[94,44,91,36,"authAPI"],[94,51,91,36],[94,52,91,37,"getCurrentUser"],[94,66,91,51],[94,67,91,52],[94,68,91,53],[95,8,92,6,"setUser"],[95,15,92,13],[95,16,92,14,"userData"],[95,24,92,22],[95,25,92,23],[96,8,93,6,"setIsAuthenticated"],[96,26,93,24],[96,27,93,25],[96,31,93,29],[96,32,93,30],[98,8,95,6],[99,8,96,6,"router"],[99,19,96,12],[99,20,96,12,"router"],[99,26,96,12],[99,27,96,13,"replace"],[99,34,96,20],[99,35,96,21],[99,54,96,40],[99,55,96,41],[100,6,97,4],[100,7,97,5],[100,8,97,6],[100,15,97,13,"error"],[100,20,97,23],[100,22,97,25],[101,8,98,6,"console"],[101,15,98,13],[101,16,98,14,"error"],[101,21,98,19],[101,22,98,20],[101,52,98,50],[101,54,98,52,"error"],[101,59,98,57],[101,60,98,58],[102,8,99,6],[102,14,99,12],[102,18,99,16,"Error"],[102,23,99,21],[102,24,100,8,"error"],[102,29,100,13],[102,30,100,14,"response"],[102,38,100,22],[102,40,100,24,"data"],[102,44,100,28],[102,46,100,30,"detail"],[102,52,100,36],[102,56,101,8],[102,89,102,6],[102,90,102,7],[103,6,103,4],[103,7,103,5],[103,16,103,14],[104,8,104,6,"setIsLoading"],[104,20,104,18],[104,21,104,19],[104,26,104,24],[104,27,104,25],[105,6,105,4],[106,4,106,2],[106,5,106,3],[107,4,108,2],[107,10,108,8,"logout"],[107,16,108,14],[107,19,108,17],[107,25,108,17,"logout"],[107,26,108,17],[107,31,108,29],[108,6,109,4],[108,10,109,8],[109,8,110,6,"setIsLoading"],[109,20,110,18],[109,21,110,19],[109,25,110,23],[109,26,110,24],[110,8,111,6],[111,8,112,6],[111,14,112,12,"secureStorage"],[111,26,112,25],[111,27,112,25,"secureStorage"],[111,40,112,25],[111,41,112,26,"deleteItem"],[111,51,112,36],[111,52,112,37],[111,63,112,48],[111,64,112,49],[112,8,113,6,"setUser"],[112,15,113,13],[112,16,113,14],[112,20,113,18],[112,21,113,19],[113,8,114,6,"setIsAuthenticated"],[113,26,114,24],[113,27,114,25],[113,32,114,30],[113,33,114,31],[115,8,116,6],[116,8,117,6,"router"],[116,19,117,12],[116,20,117,12,"router"],[116,26,117,12],[116,27,117,13,"replace"],[116,34,117,20],[116,35,117,21],[116,38,117,24],[116,39,117,25],[117,6,118,4],[117,7,118,5],[117,8,118,6],[117,15,118,13,"error"],[117,20,118,18],[117,22,118,20],[118,8,119,6,"console"],[118,15,119,13],[118,16,119,14,"error"],[118,21,119,19],[118,22,119,20],[118,54,119,52],[118,56,119,54,"error"],[118,61,119,59],[118,62,119,60],[119,6,120,4],[119,7,120,5],[119,16,120,14],[120,8,121,6,"setIsLoading"],[120,20,121,18],[120,21,121,19],[120,26,121,24],[120,27,121,25],[121,6,122,4],[122,4,123,2],[122,5,123,3],[123,4,125,2],[123,24,126,4],[123,28,126,4,"_reactJsxDevRuntime"],[123,47,126,4],[123,48,126,4,"jsxDEV"],[123,54,126,4],[123,56,126,5,"AuthContext"],[123,67,126,16],[123,68,126,17,"Provider"],[123,76,126,25],[124,6,127,6,"value"],[124,11,127,11],[124,13,127,13],[125,8,128,8,"user"],[125,12,128,12],[126,8,129,8,"isAuthenticated"],[126,23,129,23],[127,8,130,8,"isLoading"],[127,17,130,17],[128,8,131,8,"login"],[128,13,131,13],[129,8,132,8,"register"],[129,16,132,16],[130,8,133,8,"logout"],[130,14,133,14],[131,8,134,8,"checkAuth"],[132,6,135,6],[132,7,135,8],[133,6,135,8,"children"],[133,14,135,8],[133,16,137,7,"children"],[134,4,137,15],[135,6,137,15,"fileName"],[135,14,137,15],[135,16,137,15,"_jsxFileName"],[135,28,137,15],[136,6,137,15,"lineNumber"],[136,16,137,15],[137,6,137,15,"columnNumber"],[137,18,137,15],[138,4,137,15],[138,11,138,26],[138,12,138,27],[139,2,140,0],[139,3,140,1],[140,2,142,7],[140,8,142,13,"useAuth"],[140,15,142,20],[140,18,142,23,"useAuth"],[140,19,142,23],[140,24,142,29],[141,4,143,2],[141,10,143,8,"context"],[141,17,143,15],[141,20,143,18],[141,24,143,18,"useContext"],[141,30,143,28],[141,31,143,28,"useContext"],[141,41,143,28],[141,43,143,29,"AuthContext"],[141,54,143,40],[141,55,143,41],[142,4,144,2],[142,8,144,6,"context"],[142,15,144,13],[142,20,144,18,"undefined"],[142,29,144,27],[142,31,144,29],[143,6,145,4],[143,12,145,10],[143,16,145,14,"Error"],[143,21,145,19],[143,22,145,20],[143,83,145,81],[143,84,145,82],[144,4,146,2],[145,4,147,2],[145,11,147,9,"context"],[145,18,147,16],[146,2,148,0],[146,3,148,1],[147,0,148,2],[147,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuth","register","login","logout","useAuth"],"mappings":"AAA;4BCgB;YCM;GDE;oBEE;GFqB;mBGE;GH6B;gBIE;GJyB;iBKE;GLe;CDiB;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}