{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":49,"index":139}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":140},"end":{"line":3,"column":73,"index":213}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":214},"end":{"line":4,"column":37,"index":251}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _expoSecureStore = require(_dependencyMap[1], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _servicesApi = require(_dependencyMap[2], \"../services/api\");\n  var _expoRouter = require(_dependencyMap[3], \"expo-router\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [isAuthenticated, setIsAuthenticated] = (0, _react.useState)(false);\n\n    // Vérifier l'authentification au chargement\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, []);\n    const checkAuth = async () => {\n      try {\n        const token = await SecureStore.getItemAsync('jwt_token');\n        if (token) {\n          // Vérifier si le token est valide\n          const userData = await _servicesApi.authAPI.getCurrentUser();\n          setUser(userData);\n          setIsAuthenticated(true);\n        } else {\n          setIsAuthenticated(false);\n          setUser(null);\n        }\n      } catch (error) {\n        console.error('Erreur lors de la vérification de l\\'authentification:', error);\n        setIsAuthenticated(false);\n        setUser(null);\n        // Supprimer le token s'il est invalide\n        await SecureStore.deleteItemAsync('jwt_token');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const register = async data => {\n      try {\n        setIsLoading(true);\n        // Inscription\n        const newUser = await _servicesApi.authAPI.register(data);\n\n        // Connexion automatique après inscription\n        const tokenResponse = await _servicesApi.authAPI.login({\n          email: data.email,\n          password: data.password\n        });\n\n        // Stocker le token de manière sécurisée\n        await SecureStore.setItemAsync('jwt_token', tokenResponse.access_token);\n        setUser(newUser);\n        setIsAuthenticated(true);\n\n        // Rediriger vers l'écran principal\n        _expoRouter.router.replace('/(protected)/home');\n      } catch (error) {\n        console.error('Erreur lors de l\\'inscription:', error);\n        throw new Error(error.response?.data?.detail || 'Une erreur est survenue lors de l\\'inscription');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const login = async data => {\n      try {\n        setIsLoading(true);\n        // Connexion\n        const tokenResponse = await _servicesApi.authAPI.login(data);\n\n        // Stocker le token de manière sécurisée\n        await SecureStore.setItemAsync('jwt_token', tokenResponse.access_token);\n\n        // Récupérer les données utilisateur\n        const userData = await _servicesApi.authAPI.getCurrentUser();\n        setUser(userData);\n        setIsAuthenticated(true);\n\n        // Rediriger vers l'écran principal\n        _expoRouter.router.replace('/(protected)/home');\n      } catch (error) {\n        console.error('Erreur lors de la connexion:', error);\n        throw new Error(error.response?.data?.detail || 'Email ou mot de passe incorrect');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const logout = async () => {\n      try {\n        setIsLoading(true);\n        // Supprimer le token\n        await SecureStore.deleteItemAsync('jwt_token');\n        setUser(null);\n        setIsAuthenticated(false);\n\n        // Rediriger vers l'écran de connexion\n        _expoRouter.router.replace('/');\n      } catch (error) {\n        console.error('Erreur lors de la déconnexion:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isAuthenticated,\n        isLoading,\n        login,\n        register,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth doit être utilisé à l\\'intérieur d\\'un AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":164,"map":[[23,2,18,0,"Object"],[23,8,18,0],[23,9,18,0,"defineProperty"],[23,23,18,0],[23,24,18,0,"exports"],[23,31,18,0],[24,4,18,0,"enumerable"],[24,14,18,0],[25,4,18,0,"get"],[25,7,18,0],[25,18,18,0,"get"],[25,19,18,0],[26,6,18,0],[26,13,18,0,"AuthProvider"],[26,25,18,0],[27,4,18,0],[28,2,18,0],[29,2,143,0,"Object"],[29,8,143,0],[29,9,143,0,"defineProperty"],[29,23,143,0],[29,24,143,0,"exports"],[29,31,143,0],[30,4,143,0,"enumerable"],[30,14,143,0],[31,4,143,0,"get"],[31,7,143,0],[31,18,143,0,"get"],[31,19,143,0],[32,6,143,0],[32,13,143,0,"useAuth"],[32,20,143,0],[33,4,143,0],[34,2,143,0],[35,2,1,0],[35,6,1,0,"_react"],[35,12,1,0],[35,15,1,0,"require"],[35,22,1,0],[35,23,1,0,"_dependencyMap"],[35,37,1,0],[36,2,2,0],[36,6,2,0,"_expoSecureStore"],[36,22,2,0],[36,25,2,0,"require"],[36,32,2,0],[36,33,2,0,"_dependencyMap"],[36,47,2,0],[37,2,2,0],[37,6,2,0,"SecureStore"],[37,17,2,0],[37,20,2,0,"_interopNamespace"],[37,37,2,0],[37,38,2,0,"_expoSecureStore"],[37,54,2,0],[38,2,3,0],[38,6,3,0,"_servicesApi"],[38,18,3,0],[38,21,3,0,"require"],[38,28,3,0],[38,29,3,0,"_dependencyMap"],[38,43,3,0],[39,2,4,0],[39,6,4,0,"_expoRouter"],[39,17,4,0],[39,20,4,0,"require"],[39,27,4,0],[39,28,4,0,"_dependencyMap"],[39,42,4,0],[40,2,4,37],[40,6,4,37,"_reactJsxDevRuntime"],[40,25,4,37],[40,28,4,37,"require"],[40,35,4,37],[40,36,4,37,"_dependencyMap"],[40,50,4,37],[41,2,16,0],[41,8,16,6,"AuthContext"],[41,19,16,17],[41,35,16,20],[41,39,16,20,"createContext"],[41,45,16,33],[41,46,16,33,"createContext"],[41,59,16,33],[41,61,16,63,"undefined"],[41,70,16,72],[41,71,16,73],[42,2,18,7],[42,8,18,13,"AuthProvider"],[42,20,18,25],[42,23,18,28,"AuthProvider"],[42,24,18,29],[43,4,18,31,"children"],[44,2,18,65],[44,3,18,66],[44,8,18,71],[45,4,19,2],[45,10,19,8],[45,11,19,9,"user"],[45,15,19,13],[45,17,19,15,"setUser"],[45,24,19,22],[45,25,19,23],[45,28,19,26],[45,32,19,26,"useState"],[45,38,19,34],[45,39,19,34,"useState"],[45,47,19,34],[45,49,19,48],[45,53,19,52],[45,54,19,53],[46,4,20,2],[46,10,20,8],[46,11,20,9,"isLoading"],[46,20,20,18],[46,22,20,20,"setIsLoading"],[46,34,20,32],[46,35,20,33],[46,38,20,36],[46,42,20,36,"useState"],[46,48,20,44],[46,49,20,44,"useState"],[46,57,20,44],[46,59,20,45],[46,63,20,49],[46,64,20,50],[47,4,21,2],[47,10,21,8],[47,11,21,9,"isAuthenticated"],[47,26,21,24],[47,28,21,26,"setIsAuthenticated"],[47,46,21,44],[47,47,21,45],[47,50,21,48],[47,54,21,48,"useState"],[47,60,21,56],[47,61,21,56,"useState"],[47,69,21,56],[47,71,21,57],[47,76,21,62],[47,77,21,63],[49,4,23,2],[50,4,24,2],[50,8,24,2,"useEffect"],[50,14,24,11],[50,15,24,11,"useEffect"],[50,24,24,11],[50,26,24,12],[50,32,24,18],[51,6,25,4,"checkAuth"],[51,15,25,13],[51,16,25,14],[51,17,25,15],[52,4,26,2],[52,5,26,3],[52,7,26,5],[52,9,26,7],[52,10,26,8],[53,4,28,2],[53,10,28,8,"checkAuth"],[53,19,28,17],[53,22,28,20],[53,28,28,20,"checkAuth"],[53,29,28,20],[53,34,28,32],[54,6,29,4],[54,10,29,8],[55,8,30,6],[55,14,30,12,"token"],[55,19,30,17],[55,22,30,20],[55,28,30,26,"SecureStore"],[55,39,30,37],[55,40,30,38,"getItemAsync"],[55,52,30,50],[55,53,30,51],[55,64,30,62],[55,65,30,63],[56,8,31,6],[56,12,31,10,"token"],[56,17,31,15],[56,19,31,17],[57,10,32,8],[58,10,33,8],[58,16,33,14,"userData"],[58,24,33,22],[58,27,33,25],[58,33,33,31,"authAPI"],[58,45,33,38],[58,46,33,38,"authAPI"],[58,53,33,38],[58,54,33,39,"getCurrentUser"],[58,68,33,53],[58,69,33,54],[58,70,33,55],[59,10,34,8,"setUser"],[59,17,34,15],[59,18,34,16,"userData"],[59,26,34,24],[59,27,34,25],[60,10,35,8,"setIsAuthenticated"],[60,28,35,26],[60,29,35,27],[60,33,35,31],[60,34,35,32],[61,8,36,6],[61,9,36,7],[61,15,36,13],[62,10,37,8,"setIsAuthenticated"],[62,28,37,26],[62,29,37,27],[62,34,37,32],[62,35,37,33],[63,10,38,8,"setUser"],[63,17,38,15],[63,18,38,16],[63,22,38,20],[63,23,38,21],[64,8,39,6],[65,6,40,4],[65,7,40,5],[65,8,40,6],[65,15,40,13,"error"],[65,20,40,18],[65,22,40,20],[66,8,41,6,"console"],[66,15,41,13],[66,16,41,14,"error"],[66,21,41,19],[66,22,41,20],[66,78,41,76],[66,80,41,78,"error"],[66,85,41,83],[66,86,41,84],[67,8,42,6,"setIsAuthenticated"],[67,26,42,24],[67,27,42,25],[67,32,42,30],[67,33,42,31],[68,8,43,6,"setUser"],[68,15,43,13],[68,16,43,14],[68,20,43,18],[68,21,43,19],[69,8,44,6],[70,8,45,6],[70,14,45,12,"SecureStore"],[70,25,45,23],[70,26,45,24,"deleteItemAsync"],[70,41,45,39],[70,42,45,40],[70,53,45,51],[70,54,45,52],[71,6,46,4],[71,7,46,5],[71,16,46,14],[72,8,47,6,"setIsLoading"],[72,20,47,18],[72,21,47,19],[72,26,47,24],[72,27,47,25],[73,6,48,4],[74,4,49,2],[74,5,49,3],[75,4,51,2],[75,10,51,8,"register"],[75,18,51,16],[75,21,51,19],[75,27,51,26,"data"],[75,31,51,44],[75,35,51,49],[76,6,52,4],[76,10,52,8],[77,8,53,6,"setIsLoading"],[77,20,53,18],[77,21,53,19],[77,25,53,23],[77,26,53,24],[78,8,54,6],[79,8,55,6],[79,14,55,12,"newUser"],[79,21,55,19],[79,24,55,22],[79,30,55,28,"authAPI"],[79,42,55,35],[79,43,55,35,"authAPI"],[79,50,55,35],[79,51,55,36,"register"],[79,59,55,44],[79,60,55,45,"data"],[79,64,55,49],[79,65,55,50],[81,8,57,6],[82,8,58,6],[82,14,58,12,"tokenResponse"],[82,27,58,25],[82,30,58,28],[82,36,58,34,"authAPI"],[82,48,58,41],[82,49,58,41,"authAPI"],[82,56,58,41],[82,57,58,42,"login"],[82,62,58,47],[82,63,58,48],[83,10,59,8,"email"],[83,15,59,13],[83,17,59,15,"data"],[83,21,59,19],[83,22,59,20,"email"],[83,27,59,25],[84,10,60,8,"password"],[84,18,60,16],[84,20,60,18,"data"],[84,24,60,22],[84,25,60,23,"password"],[85,8,61,6],[85,9,61,7],[85,10,61,8],[87,8,63,6],[88,8,64,6],[88,14,64,12,"SecureStore"],[88,25,64,23],[88,26,64,24,"setItemAsync"],[88,38,64,36],[88,39,64,37],[88,50,64,48],[88,52,64,50,"tokenResponse"],[88,65,64,63],[88,66,64,64,"access_token"],[88,78,64,76],[88,79,64,77],[89,8,66,6,"setUser"],[89,15,66,13],[89,16,66,14,"newUser"],[89,23,66,21],[89,24,66,22],[90,8,67,6,"setIsAuthenticated"],[90,26,67,24],[90,27,67,25],[90,31,67,29],[90,32,67,30],[92,8,69,6],[93,8,70,6,"router"],[93,19,70,12],[93,20,70,12,"router"],[93,26,70,12],[93,27,70,13,"replace"],[93,34,70,20],[93,35,70,21],[93,54,70,40],[93,55,70,41],[94,6,71,4],[94,7,71,5],[94,8,71,6],[94,15,71,13,"error"],[94,20,71,23],[94,22,71,25],[95,8,72,6,"console"],[95,15,72,13],[95,16,72,14,"error"],[95,21,72,19],[95,22,72,20],[95,54,72,52],[95,56,72,54,"error"],[95,61,72,59],[95,62,72,60],[96,8,73,6],[96,14,73,12],[96,18,73,16,"Error"],[96,23,73,21],[96,24,74,8,"error"],[96,29,74,13],[96,30,74,14,"response"],[96,38,74,22],[96,40,74,24,"data"],[96,44,74,28],[96,46,74,30,"detail"],[96,52,74,36],[96,56,75,8],[96,104,76,6],[96,105,76,7],[97,6,77,4],[97,7,77,5],[97,16,77,14],[98,8,78,6,"setIsLoading"],[98,20,78,18],[98,21,78,19],[98,26,78,24],[98,27,78,25],[99,6,79,4],[100,4,80,2],[100,5,80,3],[101,4,82,2],[101,10,82,8,"login"],[101,15,82,13],[101,18,82,16],[101,24,82,23,"data"],[101,28,82,38],[101,32,82,43],[102,6,83,4],[102,10,83,8],[103,8,84,6,"setIsLoading"],[103,20,84,18],[103,21,84,19],[103,25,84,23],[103,26,84,24],[104,8,85,6],[105,8,86,6],[105,14,86,12,"tokenResponse"],[105,27,86,25],[105,30,86,28],[105,36,86,34,"authAPI"],[105,48,86,41],[105,49,86,41,"authAPI"],[105,56,86,41],[105,57,86,42,"login"],[105,62,86,47],[105,63,86,48,"data"],[105,67,86,52],[105,68,86,53],[107,8,88,6],[108,8,89,6],[108,14,89,12,"SecureStore"],[108,25,89,23],[108,26,89,24,"setItemAsync"],[108,38,89,36],[108,39,89,37],[108,50,89,48],[108,52,89,50,"tokenResponse"],[108,65,89,63],[108,66,89,64,"access_token"],[108,78,89,76],[108,79,89,77],[110,8,91,6],[111,8,92,6],[111,14,92,12,"userData"],[111,22,92,20],[111,25,92,23],[111,31,92,29,"authAPI"],[111,43,92,36],[111,44,92,36,"authAPI"],[111,51,92,36],[111,52,92,37,"getCurrentUser"],[111,66,92,51],[111,67,92,52],[111,68,92,53],[112,8,93,6,"setUser"],[112,15,93,13],[112,16,93,14,"userData"],[112,24,93,22],[112,25,93,23],[113,8,94,6,"setIsAuthenticated"],[113,26,94,24],[113,27,94,25],[113,31,94,29],[113,32,94,30],[115,8,96,6],[116,8,97,6,"router"],[116,19,97,12],[116,20,97,12,"router"],[116,26,97,12],[116,27,97,13,"replace"],[116,34,97,20],[116,35,97,21],[116,54,97,40],[116,55,97,41],[117,6,98,4],[117,7,98,5],[117,8,98,6],[117,15,98,13,"error"],[117,20,98,23],[117,22,98,25],[118,8,99,6,"console"],[118,15,99,13],[118,16,99,14,"error"],[118,21,99,19],[118,22,99,20],[118,52,99,50],[118,54,99,52,"error"],[118,59,99,57],[118,60,99,58],[119,8,100,6],[119,14,100,12],[119,18,100,16,"Error"],[119,23,100,21],[119,24,101,8,"error"],[119,29,101,13],[119,30,101,14,"response"],[119,38,101,22],[119,40,101,24,"data"],[119,44,101,28],[119,46,101,30,"detail"],[119,52,101,36],[119,56,102,8],[119,89,103,6],[119,90,103,7],[120,6,104,4],[120,7,104,5],[120,16,104,14],[121,8,105,6,"setIsLoading"],[121,20,105,18],[121,21,105,19],[121,26,105,24],[121,27,105,25],[122,6,106,4],[123,4,107,2],[123,5,107,3],[124,4,109,2],[124,10,109,8,"logout"],[124,16,109,14],[124,19,109,17],[124,25,109,17,"logout"],[124,26,109,17],[124,31,109,29],[125,6,110,4],[125,10,110,8],[126,8,111,6,"setIsLoading"],[126,20,111,18],[126,21,111,19],[126,25,111,23],[126,26,111,24],[127,8,112,6],[128,8,113,6],[128,14,113,12,"SecureStore"],[128,25,113,23],[128,26,113,24,"deleteItemAsync"],[128,41,113,39],[128,42,113,40],[128,53,113,51],[128,54,113,52],[129,8,114,6,"setUser"],[129,15,114,13],[129,16,114,14],[129,20,114,18],[129,21,114,19],[130,8,115,6,"setIsAuthenticated"],[130,26,115,24],[130,27,115,25],[130,32,115,30],[130,33,115,31],[132,8,117,6],[133,8,118,6,"router"],[133,19,118,12],[133,20,118,12,"router"],[133,26,118,12],[133,27,118,13,"replace"],[133,34,118,20],[133,35,118,21],[133,38,118,24],[133,39,118,25],[134,6,119,4],[134,7,119,5],[134,8,119,6],[134,15,119,13,"error"],[134,20,119,18],[134,22,119,20],[135,8,120,6,"console"],[135,15,120,13],[135,16,120,14,"error"],[135,21,120,19],[135,22,120,20],[135,54,120,52],[135,56,120,54,"error"],[135,61,120,59],[135,62,120,60],[136,6,121,4],[136,7,121,5],[136,16,121,14],[137,8,122,6,"setIsLoading"],[137,20,122,18],[137,21,122,19],[137,26,122,24],[137,27,122,25],[138,6,123,4],[139,4,124,2],[139,5,124,3],[140,4,126,2],[140,24,127,4],[140,28,127,4,"_reactJsxDevRuntime"],[140,47,127,4],[140,48,127,4,"jsxDEV"],[140,54,127,4],[140,56,127,5,"AuthContext"],[140,67,127,16],[140,68,127,17,"Provider"],[140,76,127,25],[141,6,128,6,"value"],[141,11,128,11],[141,13,128,13],[142,8,129,8,"user"],[142,12,129,12],[143,8,130,8,"isAuthenticated"],[143,23,130,23],[144,8,131,8,"isLoading"],[144,17,131,17],[145,8,132,8,"login"],[145,13,132,13],[146,8,133,8,"register"],[146,16,133,16],[147,8,134,8,"logout"],[147,14,134,14],[148,8,135,8,"checkAuth"],[149,6,136,6],[149,7,136,8],[150,6,136,8,"children"],[150,14,136,8],[150,16,138,7,"children"],[151,4,138,15],[152,6,138,15,"fileName"],[152,14,138,15],[152,16,138,15,"_jsxFileName"],[152,28,138,15],[153,6,138,15,"lineNumber"],[153,16,138,15],[154,6,138,15,"columnNumber"],[154,18,138,15],[155,4,138,15],[155,11,139,26],[155,12,139,27],[156,2,141,0],[156,3,141,1],[157,2,143,7],[157,8,143,13,"useAuth"],[157,15,143,20],[157,18,143,23,"useAuth"],[157,19,143,23],[157,24,143,29],[158,4,144,2],[158,10,144,8,"context"],[158,17,144,15],[158,20,144,18],[158,24,144,18,"useContext"],[158,30,144,28],[158,31,144,28,"useContext"],[158,41,144,28],[158,43,144,29,"AuthContext"],[158,54,144,40],[158,55,144,41],[159,4,145,2],[159,8,145,6,"context"],[159,15,145,13],[159,20,145,18,"undefined"],[159,29,145,27],[159,31,145,29],[160,6,146,4],[160,12,146,10],[160,16,146,14,"Error"],[160,21,146,19],[160,22,146,20],[160,83,146,81],[160,84,146,82],[161,4,147,2],[162,4,148,2],[162,11,148,9,"context"],[162,18,148,16],[163,2,149,0],[163,3,149,1],[164,0,149,2],[164,3]],"functionMap":{"names":["<global>","AuthProvider","useEffect$argument_0","checkAuth","register","login","logout","useAuth"],"mappings":"AAA;4BCiB;YCM;GDE;oBEE;GFqB;mBGE;GH6B;gBIE;GJyB;iBKE;GLe;CDiB;uBOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}